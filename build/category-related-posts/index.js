(()=>{"use strict";var e,t={299:(e,t,l)=>{const a=window.React,o=window.wp.blocks,n=(window.wp.i18n,window.wp.blockEditor),r=window.wp.components,s=window.wp.element,i=window.wp.apiFetch;var c=l.n(i);const d=window.wp.data;function m({initialTitle:e,onSave:t,postId:l,style:o}){const[r,i]=(0,s.useState)(e),[c,d]=(0,s.useState)(!1);return(0,a.createElement)("div",null,c?(0,a.createElement)(a.Fragment,null,(0,a.createElement)(n.RichText,{tagName:"h4",value:r,onChange:e=>{i(e)},onBlur:async()=>{d(!1),t(r,l)},autoFocus:!0})):(0,a.createElement)("h4",{onDoubleClick:()=>{d(!0)},className:"relatedPostTitle",style:o},r))}function u(e){const t=document.createElement("div");t.innerHTML=e;let l=t.innerText;return l.length>0&&(l=l.slice(0,150)+"..."),l}const p=JSON.parse('{"UU":"create-block/category-related-posts"}'),g=(0,a.createElement)("svg",{class:"w-6 h-6 text-gray-800 dark:text-white","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},(0,a.createElement)("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m10.8 17.8-6.4 2.1 2.1-6.4m4.3 4.3L19 9a3 3 0 0 0-4-4l-8.4 8.6m4.3 4.3-4.3-4.3m2.1 2.1L15 9.1m-2.1-2 4.2 4.2"}));(0,o.registerBlockType)(p.UU,{icon:g,edit:function({attributes:e,setAttributes:t}){const{heading:l,colorValue:o,backgroundColor:i,textAlign:p,relatedPostsTitle:g,relatedPostsDescription:h,columnValue:E,postToDisplay:v,headingTags:w}=e;(0,s.useEffect)((()=>{(async()=>{try{const e=(0,d.select)("core/editor").getCurrentPostId(),l=(await c()({path:`/wp/v2/posts/${e}?_fields=categories`})).categories,a=(await c()({path:"/wp/v2/posts?per_page=100"})).filter((t=>t.categories.some((e=>l.includes(e)))&&t.id!==e)).map((e=>({id:e.id,title:e.title.rendered,content:u(e.content.rendered),link:e.link})));t({relatedPosts:a})}catch(e){console.error("Error fetching related posts:",e)}})()}),[t]);const C=async(l,a)=>{try{await c()({path:`/wp/v2/posts/${a}`,method:"POST",data:{title:l}});const o=e.relatedPosts.map((e=>e.id===a?{...e,title:l}:e));t({relatedPosts:o})}catch(e){console.error("Error updating post title: ",e)}},P=e=>{t({heading:e})};return(0,a.createElement)("div",{...(0,n.useBlockProps)()},(0,a.createElement)("div",null,(0,a.createElement)(n.BlockControls,null,(0,a.createElement)(a.Fragment,null,(0,a.createElement)(n.AlignmentToolbar,{value:p,onChange:e=>{t({textAlign:e})}}),(0,a.createElement)(r.SelectControl,{value:w,options:[{label:"H1",tagName:"h1"},{label:"H2",tagName:"h2"},{label:"H3",tagName:"h3"},{label:"H4",tagName:"h4"},{label:"H5",tagName:"h5"},{label:"H6",tagName:"h6"}],onChange:e=>{t({headingTags:e})}}))),(0,a.createElement)(n.InspectorControls,null,(0,a.createElement)(r.Panel,{header:"Styles",initialOpen:!1},(0,a.createElement)(r.PanelBody,{title:"Color",initialOpen:!1},(0,a.createElement)(r.PanelRow,{tagName:"h6"},"Header Text Color"),(0,a.createElement)(n.ColorPaletteControl,{value:o,onChange:e=>{t({colorValue:e})}}),(0,a.createElement)(r.PanelRow,null,"Header Background Color"),(0,a.createElement)(n.ColorPaletteControl,{value:i,onChange:e=>{t({backgroundColor:e})}}),(0,a.createElement)(r.PanelRow,null,"Title Color"),(0,a.createElement)(n.ColorPaletteControl,{value:g,onChange:e=>{t({relatedPostsTitle:e})}}),(0,a.createElement)(r.PanelRow,null,"Description Color"),(0,a.createElement)(n.ColorPaletteControl,{value:h,onChange:e=>{t({relatedPostsDescription:e})}})),(0,a.createElement)(r.PanelBody,{title:"Related Post",initialOpen:!1},(0,a.createElement)(r.__experimentalNumberControl,{value:v,min:1,max:6,step:1,isShiftStepEnabled:!1,onChange:e=>{t({postToDisplay:e})}})),(0,a.createElement)(r.PanelBody,{title:"Posts Column",initialOpen:!1},(0,a.createElement)(r.RangeControl,{label:"Columns",value:E,min:1,max:4,step:1,onChange:e=>{t({columnValue:e})}})))),e.relatedPosts&&e.relatedPosts.length>0?(0,a.createElement)("ul",null,(0,a.createElement)("div",{className:"richText"},(0,a.createElement)(n.RichText,{tagName:w,value:l||"Related Post",onChange:P,style:{color:o,background:i,textAlign:p},allowedFormats:["core/bold","core/italic"]})),(0,a.createElement)("div",{className:`relatedPost relatedPostColumns-${E}`},e.relatedPosts.slice(0,v).map((e=>(0,a.createElement)("li",{key:e.id,className:"relatedPostList"},(0,a.createElement)(m,{initialTitle:e.title,onSave:C,postId:e.id,style:{color:g}}),(0,a.createElement)("p",{className:"relatedpostContent",style:{color:h}},e.content)))))):(0,a.createElement)(n.RichText,{tagName:w,value:l||"No Related Post",onChange:P,style:{color:o,background:i,textAlign:p},allowedFormats:["core/bold","core/italic"]})))},save:function({attributes:e}){const{relatedPosts:t,heading:l,colorValue:o,backgroundColor:r,textAlign:s,relatedPostsTitle:i,relatedPostsDescription:c,columnValue:d,postToDisplay:m,headingTags:p}=e,g={color:o,background:r,textAlign:s};return(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{...n.useBlockProps.save()},(0,a.createElement)("div",null,t&&t.length>0?(0,a.createElement)("ul",null,(0,a.createElement)(n.RichText.Content,{tagName:p,value:l||"Related Post",style:g}),(0,a.createElement)("div",{className:`relatedPost relatedPostColumns-${d}`},t.slice(0,m).map(((e,t)=>(0,a.createElement)("li",{key:t,className:"relatedPostList"},(0,a.createElement)("h4",null,(0,a.createElement)("a",{href:e.link,style:{color:i},onClick:t=>((e,t)=>{e.preventDefault(),window.location.href=t})(t,e.link),className:"renderedPost"},e.title)),(0,a.createElement)("p",{style:{color:c}},u(e.content))))))):(0,a.createElement)(n.RichText.Content,{tagName:p,value:l||"No related Post",style:g}))))}})}},l={};function a(e){var o=l[e];if(void 0!==o)return o.exports;var n=l[e]={exports:{}};return t[e](n,n.exports,a),n.exports}a.m=t,e=[],a.O=(t,l,o,n)=>{if(!l){var r=1/0;for(d=0;d<e.length;d++){for(var[l,o,n]=e[d],s=!0,i=0;i<l.length;i++)(!1&n||r>=n)&&Object.keys(a.O).every((e=>a.O[e](l[i])))?l.splice(i--,1):(s=!1,n<r&&(r=n));if(s){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[l,o,n]},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var l in t)a.o(t,l)&&!a.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={890:0,598:0};a.O.j=t=>0===e[t];var t=(t,l)=>{var o,n,[r,s,i]=l,c=0;if(r.some((t=>0!==e[t]))){for(o in s)a.o(s,o)&&(a.m[o]=s[o]);if(i)var d=i(a)}for(t&&t(l);c<r.length;c++)n=r[c],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(d)},l=globalThis.webpackChunkrelatedposts=globalThis.webpackChunkrelatedposts||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))})();var o=a.O(void 0,[598],(()=>a(299)));o=a.O(o)})();